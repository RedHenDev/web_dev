<canvas id="mom" width="600" height="600"></canvas>

<script>

//*********************************
document.addEventListener('keydown', (event) => {
	let name = event.key;
	let code = event.code;
	render(code);
	// My first template literal.
	//alert(`Key pressed ${name} \r\n Key code value: ${code}`);
},false);
//*********************************
	
let width=128;
let height=128;
let demiWidth=width*0.5;
let demiHeight=height*0.5;
let zoomFactor=1.004;
// RGB multipliers.
let rMult=1;
let gMult=6;
let bMult=3;
// Steering strength.
let steer=0.004;
let cellStep=3;
	
let m = document.getElementById("mom").getContext("2d");

Atom = function(x,y,c){
		m.fillStyle=c;
		m.fillRect(x,y,cellStep,cellStep);
		}


let zoomX=width;
let zoomY=height;
//let xOff=0.12;
//let yOff=0.86;
let xOff=0.12;
let yOff=0.9;

setInterval(render,1000/32);

render();

function render(_dir){
console.log(_dir);
//m.clearRect(0,0,width+1,height+1);
zoomX*=zoomFactor;
zoomY*=zoomFactor;

// For steering.
let dirX=0;
let dirY=0;
	
if (_dir==="ArrowUp" || _dir==="KeyW"){
		dirY=-steer;}
else if (_dir==="ArrowDown" || _dir==="KeyS"){
		dirY=steer;}
else if (_dir==="ArrowRight" || _dir==="KeyD"){
		dirX=steer;}
else if (_dir==="ArrowLeft" || _dir==="KeyA"){
		dirX=-steer;}

xOff+=dirX;
yOff+=dirY;

for (let y=0;y<width;y++){
for (let x=0;x<height;x++){


let rad = 64;
let dx = (x-demiWidth)/zoomX-xOff;
let dy = (y-demiHeight)/zoomY-yOff;
let a = dx;
let b = dy;

for (let t=1;t<640;t++){
let d = (a*a)-(b*b)+dx;
b = 2*(a*b)+dy;
a = d;
let H = d>rad;

if (H){Atom(x,y,"rgb("+t*rMult+","+t*gMult+","+t*bMult+")");break;}

}
}
}
} // render.

</script>